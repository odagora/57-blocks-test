<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
</head>
<body>
    <main class="d-flex flex-column text-center mx-4 mt-5 h-50">
        <h1 class="mb-4">Login</h1>
        <div></div>
        <form class="d-flex flex-column w-50 mx-auto">
            <input type="text" name="email" id="email" class="form-control mb-4" placeholder="Email address">
            <input type="password" name="password" id="password" class="form-control mb-4" placeholder="Password">
            <button type="submit" class="btn btn-primary btn-block mb-4">Login</button>
        </form>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
    <script>
        const loginForm = document.querySelector('form');
        const loginButton = document.querySelector('button');

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            saveUser();
        })

        function getUsers(){
            const user = localStorage.getItem('users');
            let users = [];

            user ? users = user : users = [];

            return users;
        }
        function saveUser(){
            const email = loginForm.email.value;
            const password = loginForm.password.value;
            const loggedUsers = getUsers();
            let login = false;

            if (loggedUsers.some(user => user.email== email)) {
                alert("duplicate data");
            } else {
                loggedUsers.push({
                    "email": email,
                    "password": password,
                    "login": !login,
                });

                localStorage.setItem('users', JSON.stringify(loggedUsers));
                login = true;
                window.location.href = "home.html";
            }
        }
        (function loadPage(){
            const users = getUsers();
            console.log("Hello")
            if (users.length === 0) {
                return;
            } else {
                if (JSON.parse(getUsers())[0].login === true) {
                    window.location.href = "home.html";
                } else {
                    return;
                }
            }
        })();
    </script>
</body>
</html>